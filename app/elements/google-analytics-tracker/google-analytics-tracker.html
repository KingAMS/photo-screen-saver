<link rel="import" href="../../bower_components/polymer/polymer.html">

<!--
An element that provides Google Analytics page Tracking that will work
from a Chrome Extension.

Example:

    <google-analytics-tracker id="UAXXXXXXXX-X" page="/me.html">
			</google-analytics-tracker>

@element google-analytics-tracker
@demo demo/index.html
@hero hero.svg
-->
<script>
'use-strict';

	Polymer({
		is: 'google-analytics-tracker',

		properties: {

			/**
       * The product ID you wish to use
       *
       * @type {{name: string, image: string}}
       */
			id: {
				type: String
			},

			/**
			 * The page URI to send
			 *
			 * @type {{name: string, image: string}}
			 */
			page: {
				type: String
			}

		},

		ready: function() {
			// Standard Google Universal Analytics code
			console.log('id',this.get('id'));
			(function (i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
					(i[r].q = i[r].q || []).push(arguments);
				}, i[r].l = 1 * new Date(); a = s.createElement(o),
				m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
			})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga'); // Note: https protocol here

			ga('create', this.get('id'), 'auto');
			ga('set', 'checkProtocolTask', function () { }); // Removes failing protocol check. @see: http://stackoverflow.com/a/22152353/1958200
			ga('require', 'displayfeatures');
			ga('send', 'pageview', this.get('page'));
		}

	});
</script>
